---
title: "National Parks Analysis"
author: "Us!"
date: "8/22/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The plan

We'll be mob programming in small teams to learn ggplot2. We'll be exploring data on visits to US National Parks (sourced from the National Park Service at https://irma.nps.gov/Stats/SSRSReports).  


The presentation is [here]().


## Load libraries and data 

The `tidyverse` package has `ggplot2`, as well as `dplyr`, which we will use today.

```{r load, message=FALSE, warning=FALSE}
library(tidyverse) # install.packages('tidyverse')

np_visit <- read_csv("data/np_visit.csv")
```

## Demo code

```{r, warning=FALSE, message=FALSE}
library(tidyverse)

np_visit <- read_csv("data/np_visit.csv")

dino_nm <- np_visit %>% 
  filter(park_name == "Dinosaur National Monument")
  
ggplot(data = dino_nm, aes(x = year, y = visitors)) +
  geom_point()
```


## Exploring and wrangling data, pre-plotting // renamed

To get a better sense of the dataset and what we may want to plot, we can do some preliminary wrangling/exploration.

Here are some common functions: 

- head
- tail
- summary()
- View()

Helpful functions from `dplyr`

Also part of the `tidyverse`

- filter
- select
- %>%


Some geoms: 
-


## Plotting tasks

Resources: 

- [cheatsheet]()
- [tidyverse/ggplot]()

### Plot California National Parks by color

Try this as both a `geom_point` and a `geom_line`

Hint: `geom_point(aes(color = park_name))`
```{r}
## wrangling code:
np_ca <- np_visit %>% 
  filter(state == "CA" & type == "National Park") %>% 
  arrange(park_name, year)

## ggplot code:
```


### Visualize the average visitation to National Parks in California

Keep in mind that the type of graph you’re trying to create needs to be compatible with the data you’re telling it to use.

Hint: `geom_boxplot`  
```{r}
## wrangling code:
np_ca <- np_visit %>% # introduce pipe operator?
  filter(state == "CA" & type == "National Park") %>% 
  arrange(park_name, year)

## plotting code:
```
  
Bonus: try `geom_jitter`!

### Plot visitor counts from 2016 for all of the National Parks and Monuments

Hint: `geom_bar`
```{r}
visit_16 <- np_visit %>% 
  filter(year == 2016) %>% 
  filter(type == "National Park" | 
           type == "National Monument")
```

#### Bonus

Now color them by region: 

try: `fill = region`

And control whether they are stacked (default) or not:

`position = "dodge"`

### How many parks in each region?

Add text: The "region" varible defines the US by region. Use a bargraph to show how many parks are in each region. 

Hint: `geom_bar`

```{r}
## wrangling code:
per_state <- np_visit %>% 
  group_by(state) %>% 
  mutate(n_parks = n()) %>% 
  select(state, n_parks) %>% 
  distinct() %>% 
  arrange(desc(n_parks)) %>% 
  ungroup()

## plotting code:

```

### Plot all California National Parks

Considering our CA National Parks Visitation, what if we wanted each National Park to exist in its own graphics space? Would we need to create a new graph for each? No - we can use facet_wrap to split up the graph by a variable that we pick (here, park_name).

Hint: `facet_wrap(~park_name)`

```{r}
## wrangling:
np_ca <- np_visit %>% # introduce pipe operator?
  filter(state == "CA" & type == "National Park") %>% 
  arrange(park_name, year)

## ggplot:
```



For park X, which year had the most number of visits

These are some questions you can answer as you figure out what to plot

##

- How many years of data does this dataset have? hint: summary()

- Which parks, and how many parks, are in the dataset?


## Other questions to explore


1. Can you create a plot that shows the trend in visitation to your favorite national park over time
1. How many national parks were established in each year in the US between XXXX and XXXX?

